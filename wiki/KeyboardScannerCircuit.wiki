#summary Information for building a keyboard scanner circuit.

= Introduction =
The key scanning circuit provides the electronic interface between the key switches and the micro-controller.  Digital keyboards have many key switches.  At least 88*2 are required for a velocity sensitive standard piano layout, and many experimental designs call for many more.  Most microcontrollers have on the order of 10-20 digital I/O pins, so some scanning circuitry is necessary for all but the most trivial keyboards.

== Useful Parts ==
SN74LS138N is the only DIP 3->8 pin decoder on digikey.  Nice old school TTL logic family chip.

I'm really happy with the atmel atmega168 that I started using thanks to the excellent work of the [http://www.arduino.cc  arduino project], which is a cheaper and easier to use branch of the [http://www.wiring.org.co/ Wiring Project].  The standard board can be programmed over USB, and it has a cross-platform IDE that really just works, even in OS X! 

== An outline for an 88 key design using an Arduino ==
2 Arduino outputs -> 4 bit Binary Counter -> 4 to 16 Decoder (really a couple 3 by 8's ) -> 16 x 11 diode matrix -> 11 Arduino inputs.   Leaving one pin for serial transmission.

This design uses every DIO pin on the Arduino and accounts for the 176 keyswitches required for a velocity sensitive 88 key keyboard.  There are still 6 ADC inputs available to be used for pedals, pitch bend, etc.  (Note I'm banking on still being able to use the TX pin while using the RX pin as a DIO)

== Links to Scanning Circuits ==

[http://www.butterflysound.jp/midicck/e/lineup.html A japanese guy selling pre-programmed PICs for key scanning.  It takes about five, and he charges about $20 each.]

[http://www.hinton-instruments.co.uk/components/kv64/index.htm Velocity sensing IC gets 5 octaves with no further chips, 68 pin PLCC package]

[http://www.cedos.com/e510_midi_chip.htm E510 Velocity sensitive MIDI chip.  Changeover switch type. 16 PIN DIL 128 keys velocity sensitive keyboard scanner]

Some DIY keyboard scanners based on PIC16F84:
 * http://www.geocities.com/JDPetkov/Hardware/mkcv96/mkcv96.htm
 * http://www.geocities.com/JDPetkov/Hardware/mkc128/mkc128.htm  
 * http://www.geocities.com/JDPetkov/Hardware/midikeyb/midikeyb.htm  (No velocity sensing)

[http://www.meadowfield.freeuk.com/synth/midiscan.PDF A DIY project, based on microcontroller, uses 74HC138 decoder chip]

[http://tomscarff.tripod.com/key2midi/key2midi.htm MIDI keyboard Encoder (No velocity sensing)]

== Circuit Board Layout and Fabrication ==
One fab house popular among DIYers: 
http://www.4pcb.com/